{% sw_extends '@Storefront/storefront/component/product/card/box-standard.html.twig' %}

{% block component_product_box_price %}
    {% set hidePrice = false %}
    
    {# Check request attributes first (works for both normal and AJAX requests) #}
    {% if app.request.attributes.get('hidePrice') and app.request.attributes.get('hidePrice').hide %}
        {% set hidePrice = true %}
    {# Fallback to page extension (for normal page loads) #}
    {% elseif page.extensions.hidePrice is defined and page.extensions.hidePrice.hide %}
        {% set hidePrice = true %}
    {% endif %}
    
    {% if hidePrice %}
        {# Price is hidden #}
    {% else %}
        {{ parent() }}
    {% endif %}
{% endblock %}
